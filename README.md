# Purchase Report System
## Overview
This project is a full-stack system that fetches data from an API, stores it in a database, and generates a report on the top purchasers and total amount spent. The backend is built using Laravel, and the frontend is built using React. I have applied raw CSS is  to style the components.

## Features

- Fetches user, product, and purchase history data from an API.
- Stores fetched data in a relational database using Laravel's Eloquent ORM.
- Displays a report of the top purchasers, including product name, quantity, price, and total amount spent.
- Calculates and displays the gross total of the purchases.
- Clean, intuitive user interface with a "Generate Report" button to trigger the data fetching and report generation.

## Technology Stack

- Backend: Laravel (PHP)
- Frontend: React (JavaScript)
- Database: MySQL (or any other supported by Laravel)
- HTTP Requests: Axios (React) and Laravel's Http client for API calls.
- CSS: Raw CSS

## Installation and Setup

Prerequisites-
- PHP (>= 7.4)
- Composer
- MySQL (or any other database supported by Laravel)
- Node.js and npm (for React frontend)
- Laravel installed globally

## Backend Setup (Laravel)
1. Clone the repository:

```bash
git clone https://github.com/Md-Abed-Hossen/purchase-report-system.git
cd purchase-report-system/Laravel_backend
```
2. Install dependencies:
```bash
composer install
``` 
3. Configure environment variables: Copy the .env.example to `.env` and configure the database and API URL:
```bash
cp .env.example .env
``` 
Update the following variables in `.env`:
```bash
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=report
DB_USERNAME=root
DB_PASSWORD=
``` 
4. Run migrations: Create the necessary tables in the database by running:
```bash
php artisan migrate
``` 
The server will run on http://localhost:8000
## Frontend Setup (React)
1. Navigate to the frontend directory:
```bash
cd purchase-report-system/react
``` 
2. Install dependencies:
```bash
npm install
``` 
3. Run the React development server:
```bash
npm run dev
``` 
The React app will run on http://localhost:5173
## Usage
## Generating the Report
- After running the backend and frontend servers, navigate to the frontend in your browser (http://localhost:5173).
- Click the "Generate Report" button.
- The frontend will send a request to the Laravel backend (http://localhost:8000/api/generate-report), which fetches the latest data from the API and stores it in the database.
- Once the data is fetched, a report will be displayed, showing the top purchasers, total quantities, prices, and gross total.
## Code Explanation
## Backend (Laravel)
- The ReportController handles API data fetching, storing it in the User, Product, and PurchaseHistory models.
- Data is fetched from the external API (https://raw.githubusercontent.com/Bit-Code-Technologies/mockapi/main/purchase.json).
- Data is stored using Laravel's updateOrCreate() method to ensure no duplicate entries are inserted.
- A report is generated by querying the PurchaseHistory model, calculating totals for each user, and returning the data to the frontend.
## Frontend (React)
- The frontend fetches the report using Axios and displays it in a table format.
- The generateReport function is triggered by a button click and sends an HTTP GET request to the Laravel API.
- Upon success, the report data is rendered with product names, customer names, quantities, prices, and totals.
- Error handling is implemented in case the report generation fails.
## SQL Query
The report generation in Laravel uses a query to sum up purchases for each user and calculate the total spent:
```sql
SELECT users.name AS customer_name, products.name AS product_name, SUM(purchase_history.quantity) AS total_quantity, SUM(purchase_history.quantity * products.price) AS total_spent
FROM purchase_history
JOIN users ON purchase_history.user_id = users.id
JOIN products ON purchase_history.product_id = products.id
GROUP BY users.id, products.id
ORDER BY total_spent DESC;
```
## Conclusion
This project demonstrates a full-stack system that integrates an API with a relational database and provides real-time report generation. It follows best practices for both Laravel and React development, ensuring maintainability and scalability.
